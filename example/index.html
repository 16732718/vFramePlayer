<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>FramePlayer Demo</title>
    <script src="js/jquery-3.1.1.min.js"></script>
    <script src="../src/frameplayer.js"></script>
    <link rel="stylesheet" href="css/font-awesome.min.css" />
    <link rel="stylesheet" href="css/style.css" />
</head>
<body>
<div class="box">
    <div class="framePlayer"></div>
    <div class="control">
        <i class="fa fa-play"></i>
        <i class="fa fa-pause"></i>
        <i class="fa fa-backward"></i>
        <i class="fa fa-stop"></i>
        <i class="fa fa-forward"></i>
        <div class="process_bar">
            <div class="process"></div>
        </div>
    </div>
    <div class="info">
        <div class="curFrame">当前帧：<span></span></div>
        <div class="times">循环次数：<span></span></div>
        <div class="asc">正序：<span></span></div>
        <div class="fps">FPS：<span></span></div>
    </div>
</div>

<div class="settings">
    <div>
        <span>模式：</span>
        <label><input class="mode" name="mode" type="radio" value="true" checked /> CANVAS</label>
        <label><input class="mode" name="mode" type="radio" value="false" /> IMG</label>
    </div>
    <div>
        <label><span>开始帧：</span><input min="0" class="start" name="start" type="number" value="" /></label>
        <label><span>结束帧：</span><input min="0" class="end" name="end" type="number" value="" /></label>
    </div>
    <div>
        <label><span>FPS：</span><input min="1" max="60" class="fps" name="fps" type="number" value="" /></label>
        <label><span>次数：</span><input min="-1" class="times" name="times" type="number" value="" /></label>
    </div>
    <div>
        <label><span>yoyo：</span><input class="yoyo" name="yoyo" type="checkbox" value="" /></label>
    </div>
</div>
</body>
<script>
    $(document).ready(function(){
        var info = $(".info");
        var process = $(".process");

        var imgArr = [];
        for(var i=0;i<151;i++){
            imgArr.push("image/"+i+".jpg");
        }

        var framePlayer = new FramePlayer({
            dom : $(".framePlayer")[0],
            imgArr : imgArr,
            loop : 3,
            yoyo : true,
            isCanvas : false
        });

        var default_set = function () {
            $(".yoyo").attr("checked",framePlayer.get("yoyo"));
            $(".times").val(framePlayer.get("loop"));
            $(".fps").val(framePlayer.get("fps"));
            $(".start").val(framePlayer.get("startFrame"));
            $(".end").val(framePlayer.get("endFrame"));
            var mode_id = framePlayer.get("isCanvas")?0:1;
            $(".mode[name='mode']").eq(mode_id).attr('checked','true');
        };

        default_set();

        framePlayer.goto(framePlayer.get("startFrame"));

        framePlayer.on("play",function(){
            console.log("开始播放");
            default_set();
        });

        framePlayer.on("stop",function(){
            console.log("停止播放");
        });

        framePlayer.on("pause",function(){
            console.log("暂停播放");
        });

        framePlayer.on("update",function(frame,times,asc){
//            console.log(frame,times,asc);
            info.find(".curFrame").find("span").text(frame);
            info.find(".times").find("span").text(times);
            info.find(".asc").find("span").text(asc);
            info.find(".fps").find("span").text(framePlayer.get("fps"));

            var process_total = imgArr.length;
            var a = 100/process_total;
            process.css({"width":frame*a+"%"});
        });

//        framePlayer.set("fps",20);

        $(".fa-play").on("click",function(){
            framePlayer.play({"fps":10,"yoyo":true,onComplete:function(){
//                console.log("完成播放");
            },onUpdate:function(frame,times,asc){
//                console.log(frame,times,asc);
            }});
        });

        $(".fa-pause").on("click",function(){
            framePlayer.pause();
        });

        $(".fa-stop").on("click",function(){
            framePlayer.stop();
        });

        $(".fa-backward").on("click",function(){
            var fps = framePlayer.get("fps");
            if(Math.round(fps/1.5) > 0){
                framePlayer.set("fps",Math.round(fps/1.5));
            }
        });

        $(".fa-forward").on("click",function(){
            var fps = framePlayer.get("fps");
            if(Math.round(fps*1.5) < 60){
                framePlayer.set("fps",Math.round(fps*1.5));
            }
        });

        $(".mode").on("change",function(){
            var $selectedvalue = $("input[name='mode']:checked").val();
            var isCanvas = $selectedvalue === "true";
            framePlayer.set("isCanvas",isCanvas);
        });

        $(".times").on("change",function(){
            var times = $(this).val();
            framePlayer.set("loop",times);
        });

        $(".start").on("change",function(){
            var start = $(this).val();
            framePlayer.set("startFrame",start);
        });

        $(".end").on("change",function(){
            var end = $(this).val();
            framePlayer.set("endFrame",end);
        });

        $(".fps").on("change",function(){
            var fps = $(this).val();
            framePlayer.set("fps",fps);
        });

        $(".yoyo").on("change",function(){
            var yoyo = $(this).is(':checked');
            framePlayer.set("yoyo",yoyo);
        });


    });
</script>
</html>